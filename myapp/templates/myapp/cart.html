{% extends "base.html" %}
{% load static %}

{% block title %}Shopping Cart - ThemeMarket{% endblock %}

{% block content %}

<section class="max-w-6xl mx-auto py-10 px-4">

    <!-- Title -->
    <h2 class="text-3xl font-bold text-center text-[#0A3574] mb-10">
        Shopping Cart
    </h2>

    {% if cart.items.all %}

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

        <!-- LEFT CART ITEMS -->
        <div class="lg:col-span-2">

            <!-- Top Buttons -->
            <div class="flex items-center justify-between mb-6">
                <a href="{% url 'home' %}" 
                   class="bg-[#76C01D] text-white px-5 py-2 rounded-md shadow hover:shadow-lg transition text-sm">
                    Continue Shopping
                </a>

                <a href="{% url 'empty_cart' %}"
                   class="border px-5 py-2 text-sm rounded-md hover:bg-gray-100 transition">
                    Empty Cart
                </a>
            </div>

            <!-- Cart Loop -->
            <div class="space-y-4">

                {% for item in cart.items.all %}
                <div class="border rounded-xl shadow p-4 flex gap-4">

                    <!-- Image -->
                    <img src="{{ item.theme.image.url }}" class="w-28 h-20 object-cover rounded-lg">

                    <!-- Details -->
                    <div class="flex-1">
                        <h3 class="font-semibold text-lg">{{ item.theme.title }}</h3>

                        <p class="text-sm text-gray-600">
                            License:
                            <a href="#" class="text-blue-600 underline">Regular License</a>
                        </p>

                        <!-- Quantity Controls -->
                        <div class="flex items-center gap-3 mt-3">

                            <!-- Minus -->
                            <form action="{% url 'update_cart' item.id 'minus' %}" method="POST">
                                {% csrf_token %}
                                <button class="border px-3 rounded-md text-lg">−</button>
                            </form>

                            <!-- Quantity -->
                            <span class="px-4 py-1 border rounded-md bg-gray-100">
                                {{ item.quantity }}
                            </span>

                            <!-- Plus -->
                            <form action="{% url 'update_cart' item.id 'plus' %}" method="POST">
                                {% csrf_token %}
                                <button class="border px-3 rounded-md text-lg">+</button>
                            </form>

                            <!-- Remove -->
                            <form action="{% url 'remove_from_cart' item.id %}" method="POST" class="ml-auto">
                                {% csrf_token %}
                                <button class="text-xl text-gray-500 hover:text-red-500">×</button>
                            </form>

                        </div>
                    </div>

                    <!-- Price -->
                    <div class="text-right">
                        <p class="font-bold text-lg">${{ item.total }}</p>
                    </div>

                </div>
                {% endfor %}

            </div>

            <!-- Extend Support -->
            <div class="border rounded-xl shadow p-4 mt-4">
                <label class="text-sm">Extend support to 12 months – $6.50. Save $6.50.</label>
                <input type="text" class="w-full mt-2 border rounded-md p-2" placeholder="Learn more">
            </div>

        </div>

        <!-- RIGHT SUMMARY BOX -->
        <div class="border rounded-xl text-center shadow-md p-6 h-fit">

            <h3 class="text-lg font-bold mb-4">Your Cart Total</h3>

            <p class="text-3xl font-bold text-[#0A3574]">
                US$ {{ total_price }}
            </p>

            <p class="text-green-600 text-sm mt-1">
                Total Saving: $0
            </p>

            <a href="{% url 'checkout' %}"
               class="block bg-[#76C01D] text-center text-white py-3 mt-6 rounded-md shadow hover:shadow-lg transition font-medium">
                Secure Checkout
            </a>

            <p class="text-xs text-gray-500 mt-4">
                Prices exclude taxes and handling fees.
            </p>

        </div>

    </div>

    {% else %}
        <p class="text-center text-gray-600 text-lg mt-10">Your cart is empty.</p>
    {% endif %}

</section>

{% endblock %}
